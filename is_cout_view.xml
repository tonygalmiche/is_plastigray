<?xml version="1.0" encoding="utf-8"?>

<openerp>
    <data>


        <!-- Fiche de calcul des couts -->
        <record model="ir.ui.view" id="is_cout_calcul_form_view">
            <field name="name">is_cout_form_view</field>
            <field name="model">is.cout.calcul</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form>  
                    <header>
                        <button name="action_calcul_prix_achat"    type="object" string="Calcul des prix d'achat"    class="oe_highlight" states="creation"   confirm2="Voulez-vous vraiment lancer le calcul des prix d'achat ?" />
                        <button name="action_calcul_prix_revient"  type="object" string="Calcul des prix de revient" class="oe_highlight" states="prix_achat" confirm2="Voulez-vous vraiment lancer le calcul des prix de revient ?"/>
                        <field name="state" widget="statusbar"  clickable="True" />
                    </header>

                    <sheet>
                        <group>
                            <group string="Description">
                                <field name="name"/> 
                                <field name="user_id"/> 
                                <field name="product_id"/> 
                                <field name="segment_id"/> 
                                <field name="is_category_id"/> 
                            </group>
                        </group>
                        <group string="Coûts actualisés" >
                            <field name="cout_actualise_ids" nolabel="1">
                                <tree editable="bottom"  create="true">
                                    <field name="product_id" widget="many2one_clickable"/>
                                    <field name="cout_act_matiere"/>
                                    <field name="cout_act_machine"/>
                                    <field name="cout_act_mo"/>
                                    <field name="cout_act_st"/>
                                    <field name="cout_act_total"/>
                                </tree>
                            </field>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>
        <record model="ir.ui.view" id="is_cout_calcul_tree_view">
            <field name="name">is_cout_calcul_tree_view</field>
            <field name="model">is.cout.calcul</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="name"/> 
                    <field name="user_id"/> 
                    <field name="product_id"/> 
                    <field name="is_category_id"/> 
                    <field name="state"/> 
                </tree>
            </field>
        </record>
        <record model="ir.ui.view" id="is_cout_calcul_search_view" >
            <field name="name">is_cout_calcul_search_view</field>
            <field name="model">is.cout.calcul</field>
            <field name="arch" type="xml">
                <search>
                    <field name="name"/>
                    <field name="user_id"/> 
                </search>
            </field>
        </record>
        <record model="ir.actions.act_window" id="is_cout_calcul_action">
            <field name="name">Calcul des coûts</field>
            <field name="res_model">is.cout.calcul</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
        </record>






        <!-- Fiche détaillée du cout article -->
        <record model="ir.ui.view" id="is_cout_form_view">
            <field name="name">is_cout_form_view</field>
            <field name="model">is.cout</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form>  
                    <sheet class="oe_form_sheet_width_wider">
                        <group>
                            <group string="Description">
                                <field name="name"/> 
                                <field name="cout_calcul_id"/> 
                                <field name="type_article"/> 
                                <field name="is_category_id"/> 
                                <field name="is_gestionnaire_id"/> 
                                <field name="is_mold_id"/> 
                                <field name="uom_id"/> 
                                <field name="lot_mini"/> 
                            </group>
                            <group string="Prix"                      attrs="{'invisible': [('type_article', '!=', 'A')] }">
                                <field name="prix_tarif"              attrs="{'invisible': [('type_article', '!=', 'A')] }" /> 
                                <field name="prix_commande"           attrs="{'invisible': [('type_article', '!=', 'A')] }"/> 
                                <field name="prix_facture"            attrs="{'invisible': [('type_article', '!=', 'A')] }"/> 
                                <field name="prix_force"              attrs="{'invisible': [('type_article', '!=', 'A')] }"/> 
                                <field name="prix_force_commentaire"  attrs="{'invisible': [('prix_force', '=', 0)], 'required':  [('prix_force', '!=', 0)] }"/> 
                                <field name="prix_sous_traitance"     attrs="{'invisible': [('type_article', '!=', 'A')] }"/> 
                            </group>
                            <group string="Coût standard">
                                <field name="cout_std_matiere"/> 
                                <field name="cout_std_condition"     attrs="{'invisible': [('type_article', '=', 'A')] }"/> 
                                <field name="cout_std_machine"       attrs="{'invisible': [('type_article', '=', 'A')] }"/> 
                                <field name="cout_std_mo"            attrs="{'invisible': [('type_article', '=', 'A')] }"/> 
                                <field name="cout_std_st"            attrs="{'invisible': [('type_article', '=', 'A')] }"/> 
                                <field name="cout_std_total"         attrs="{'invisible': [('type_article', '=', 'A')] }"/> 
                                <field name="cout_std_prix_vente"    attrs="{'invisible': [('type_article', '=', 'A')] }"/> 
                                <field name="cout_std_preserie"      attrs="{'invisible': [('type_article', '=', 'A')] }"/> 
                                <field name="cout_std_amtmoule"      attrs="{'invisible': [('type_article', '=', 'A')] }"/> 
                                <field name="cout_prix_vente"        attrs="{'invisible': [('type_article', '=', 'A')] }"/> 
                            </group>

                            <group string="Coût actualisé">
                                <field name="cout_act_matiere"/> 
                                <field name="cout_act_condition"  attrs="{'invisible': [('type_article', '=', 'A')] }"/> 
                                <field name="cout_act_machine"    attrs="{'invisible': [('type_article', '=', 'A')] }"/> 
                                <field name="cout_act_mo"         attrs="{'invisible': [('type_article', '=', 'A')] }"/> 
                                <field name="cout_act_st"         attrs="{'invisible': [('type_article', '=', 'A')] }"/> 
                                <field name="cout_act_total"      attrs="{'invisible': [('type_article', '=', 'A')] }"/> 
                            </group>
                        </group>

                        <group string="Nomenclature" attrs="{'invisible': [('type_article', '=', 'A')] }">
                            <field name="nomenclature_ids" nolabel="1">
                                <tree editable="bottom"  create="true">
                                    <field name="composant" widget=""/>
                                    <field name="designation"/>
                                    <field name="unite"/>
                                    <field name="quantite"/>
                                    <field name="cout_mat"/>
                                    <field name="total_mat"/>
                                    <field name="cout_st"/>
                                    <field name="total_st"/>
                                </tree>
                            </field>
                        </group>



                        <group string="Coût machine" attrs="{'invisible': [('type_article', '=', 'A')] }">
                            <field name="gamme_ma_ids" nolabel="1">
                                <tree editable="bottom"  create="true">
                                    <field name="composant" widget=""/>
                                    <field name="sequence"/>
                                    <field name="workcenter_id" widget="many2one_clickable"/>
                                    <field name="quantite"/>
                                    <field name="cout_prepa"/>
                                    <field name="tps_prepa" widget="float_time"/>
                                    <field name="cout_fab"/>
                                    <field name="tps_fab"/>
                                    <field name="cout_total"/>
                                </tree>
                            </field>
                        </group>

                        <group string="Coût main d'oeuvre" attrs="{'invisible': [('type_article', '=', 'A')] }">
                            <field name="gamme_mo_ids" nolabel="1">
                                <tree editable="bottom"  create="true">
                                    <field name="composant" widget=""/>
                                    <field name="sequence"/>
                                    <field name="workcenter_id" widget="many2one_clickable"/>
                                    <field name="quantite"/>
                                    <field name="cout_prepa"/>
                                    <field name="tps_prepa" widget="float_time"/>
                                    <field name="cout_fab"/>
                                    <field name="tps_fab"/>
                                    <field name="cout_total"/>
                                </tree>
                            </field>
                        </group>



                    </sheet>
                </form>
            </field>
        </record>
        <record model="ir.ui.view" id="is_cout_search_view" >
            <field name="name">is_cout_search_view</field>
            <field name="model">is.cout</field>
            <field name="arch" type="xml">
                <search>
                    <field name="name"/>
                </search>
            </field>
        </record>

        <!-- Liste des couts -->
        <record model="ir.ui.view" id="is_cout_tree_view">
            <field name="name">is_cout_tree_view</field>
            <field name="model">is.cout</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="name" widget="many2one_clickable"/> 
                    <field name="cout_calcul_id"/> 
                    <field name="type_article"/> 
                    <field name="prix_tarif" /> 
                    <field name="prix_commande"/> 
                    <field name="prix_facture"/> 
                    <field name="prix_force"/> 
                    <field name="prix_calcule"/> 
                    <field name="cout_act_matiere"/> 
                    <field name="cout_act_st"/> 
                    <field name="ecart_calcule_matiere"/> 
                </tree>
            </field>
        </record>
        <record model="ir.actions.act_window" id="is_cout_action">
            <field name="name">Coût article</field>
            <field name="res_model">is.cout</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
        </record>

        <!-- Liste des anomalies -->
        <record model="ir.actions.act_window" id="is_cout_anomalie_achat_action">
            <field name="name">Anomalies achat</field>
            <field name="res_model">is.cout</field>
            <field name="view_type">form</field>
            <field name="domain">[('type_article','=','A'),('ecart_calcule_matiere','!=',0.0)]</field>
            <field name="view_mode">tree,form</field>
        </record>



  </data>
</openerp>
